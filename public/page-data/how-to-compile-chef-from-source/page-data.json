{"componentChunkName":"component---src-components-posts-post-template-index-jsx","path":"/how-to-compile-chef-from-source/","result":{"data":{"markdownRemark":{"html":"<h1 id=\"how-to-compile-chef-from-source\" style=\"position:relative;\"><a href=\"#how-to-compile-chef-from-source\" aria-label=\"how to compile chef from source permalink\" class=\"anchor-heading before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to compile Chef from source</h1>\n<p>In this blog post we will see how Chef can be built from source. This is useful\nwhen you want to install Chef on a distro or machine which is not supported by\ndefault. Which is true for most ARM processors at the time of writing this.</p>\n<h2 id=\"compiling-ruby\" style=\"position:relative;\"><a href=\"#compiling-ruby\" aria-label=\"compiling ruby permalink\" class=\"anchor-heading before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Compiling Ruby</h2>\n<p><strong>Note:</strong> You can skip this step and go directly to <a href=\"#compiling-chef\">Compiling Chef</a>, if\nyour distro already has a suitable ruby version. In my case the version was too\nold for the Chef build to work.</p>\n<p>The <a href=\"https://github.com/ruby/ruby#git\">Ruby github page</a> is very helpful when it\ncomes to compiling Ruby from source.</p>\n<p>The builing process is as easy as:</p>\n<div class=\"gatsby-code-title code-title-custom\">terminal</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ ./configure\n$ <span class=\"token function\">make</span></code></pre></div>\n<h3 id=\"installation-in-a-destination-directory\" style=\"position:relative;\"><a href=\"#installation-in-a-destination-directory\" aria-label=\"installation in a destination directory permalink\" class=\"anchor-heading before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installation in a destination directory</h3>\n<p>Now a <code class=\"language-text\">make install</code> will install Ruby in <code class=\"language-text\">/usr</code> directory, but that behavior\ncan be changed using <code class=\"language-text\">DESTDIR</code> option:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ make install DESTDIR=~/ruby</code></pre></div>\n<p>The above command will install the build in <code class=\"language-text\">~/ruby</code>. This is useful if <code class=\"language-text\">root</code>\naccess is not available, or if the build is meant to be copied to a different\nmachine.</p>\n<h3 id=\"install-ruby-globally\" style=\"position:relative;\"><a href=\"#install-ruby-globally\" aria-label=\"install ruby globally permalink\" class=\"anchor-heading before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Install Ruby globally</h3>\n<p>After building Ruby, you can install it globally by:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo cp -r ~/ruby/usr/* /usr</code></pre></div>\n<h2 id=\"compiling-chef\" style=\"position:relative;\"><a href=\"#compiling-chef\" aria-label=\"compiling chef permalink\" class=\"anchor-heading before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Compiling Chef</h2>\n<p>You will need <code class=\"language-text\">Ruby</code> and <code class=\"language-text\">bundler</code> to be installed to build Chef. <code class=\"language-text\">gem</code>\ncomes as a package with the <code class=\"language-text\">Ruby</code>.</p>\n<h3 id=\"installing-bundler\" style=\"position:relative;\"><a href=\"#installing-bundler\" aria-label=\"installing bundler permalink\" class=\"anchor-heading before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installing bundler</h3>\n<p>Make sure <code class=\"language-text\">bundler</code> is installed, if not install it:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ gem install bundler</code></pre></div>\n<h3 id=\"downloading-the-source\" style=\"position:relative;\"><a href=\"#downloading-the-source\" aria-label=\"downloading the source permalink\" class=\"anchor-heading before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Downloading the source</h3>\n<p>Download the specific version of Chef source from <a href=\"https://github.com/chef/chef/\">Chef on Github</a>\nthen extract the package.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ wget https://github.com/chef/chef/archive/v15.6.10.tar.gz\n$ tar xf v15.6.10.tar.gz\n$ cd ~/chef-15.6.10/omnibus # yes, chef is built from the omnibus folder</code></pre></div>\n<h3 id=\"installing-dependencies\" style=\"position:relative;\"><a href=\"#installing-dependencies\" aria-label=\"installing dependencies permalink\" class=\"anchor-heading before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installing dependencies</h3>\n<p>Then install the <code class=\"language-text\">gem</code>s required for building chef locally:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ bundle install --without development --path=.bundle</code></pre></div>\n<p>This will install all the dependencies in <code class=\"language-text\">.bundle</code> inside the source folder.</p>\n<h3 id=\"building-using-omnibus\" style=\"position:relative;\"><a href=\"#building-using-omnibus\" aria-label=\"building using omnibus permalink\" class=\"anchor-heading before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building using omnibus</h3>\n<p>After that start building Chef using <code class=\"language-text\">omnibus</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ bundle exec omnibus build chef -l internal</code></pre></div>\n<p><a href=\"https://github.com/chef/omnibus\">Omnibus</a> is a packaging solution which makes\nsure the packages and all its dependencies are installed in a way that are\neasily managable and will not conflict with the existing packages installed on\nyour system.</p>\n<p>Result of the above build is a package specific to your OS, in this case I'm\nbuilding Chef for Debian, so there will be a <code class=\"language-text\">.deb</code> file which I will able to\ninstall and uninstall using <code class=\"language-text\">dpkg</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ ls pkg/\nchef_15.6.10*.deb</code></pre></div>\n<h3 id=\"licensing-issues\" style=\"position:relative;\"><a href=\"#licensing-issues\" aria-label=\"licensing issues permalink\" class=\"anchor-heading before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Licensing issues</h3>\n<p>In my case the build failed because of a licensing error, you can try\nignoring licensing problems for the build, read more about that in <a href=\"https://github.com/chef/omnibus/issues/696\">issue #696</a>.</p>\n<p>In my case I fixed that by editing the <code class=\"language-text\">omnibus.rb</code> file (the omnibus config)\nand adding these two lines:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">fatal_licensing_warnings false\nfatal_transitive_dependency_licensing_warnings false</code></pre></div>\n<h3 id=\"installation-of-the-built-deb-package\" style=\"position:relative;\"><a href=\"#installation-of-the-built-deb-package\" aria-label=\"installation of the built deb package permalink\" class=\"anchor-heading before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installation of the built deb package</h3>\n<p>Now we can easily install the package:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo dpkg -i pkg/chef_15.6.10*.deb</code></pre></div>\n<p>And verify the desired version is installed:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ chef-client -v\nChef Infra Client: 15.6.10</code></pre></div>","excerpt":"How to compile Chef from source In this blog post we will see how Chef can be built from source. This is useful\nwhen you want to install…","fields":{"slug":"/how-to-compile-chef-from-source/"},"frontmatter":{"title":"How to compile Chef from source","date":"04/29/2020","tags":["How-to"]}}},"pageContext":{"slug":"/how-to-compile-chef-from-source/"}}}